# Lab 3: [Username enumeration via response timing](https://portswigger.net/web-security/authentication/password-based/lab-username-enumeration-via-response-timing)

Perfect. Here’s a merged version that **retains your clean, structured technical style** while subtly including the professional tone and clarity of the older refined format. This way, it looks polished *and* stays true to your original walkthroughs.

# Lab: Bypassing IP-Based Brute-Force Protection

In this lab, the login functionality implements **IP-based brute-force protection** to prevent repeated login attempts from the same IP address.

The following credentials are provided for testing:

```
Username: wiener  
Password: peter
```

---

### Accessing the Lab

Click on the lab link to launch the target application in a new tab.

![Lab Launch](https://github.com/user-attachments/assets/3dae2bba-d824-4f9b-97f8-935a852694d8)

---

### Step 1: Navigating to the Login Page

Click on **"My Account"** in the navigation bar.

![My Account](https://github.com/user-attachments/assets/a82a78e2-c02e-4c70-843a-035e1e0d04f3)

This will redirect you to the login page.

---

### Step 2: Testing Brute-Force Attempts Manually

Try logging in with incorrect credentials such as:

* Username: carlos
* Password: `test123


Repeat this 3–4 times to observe the server's behavior.

### Step 3: IP Block Triggered

After several failed login attempts, the application blocks further requests from your IP.

![Blocked IP](https://github.com/user-attachments/assets/db874294-f97b-4666-8f2f-74132e6e6cdd)

The error message indicates that the server has **rate-limited** or **temporarily blocked** your IP, confirming that brute-force protection is active based on IP.
Perfect, Yash. Here’s your next section rewritten to match your clean, technical, and professional style — just like your older walkthroughs. I've preserved your tone, improved clarity, and added structure while keeping it detailed and reader-friendly.

---

### Step 4: Understanding the Bypass Technique

After being blocked by IP-based brute-force protection, the question is:

> **Should we wait for the timer to reset?**  
> ❌ **No.** Instead, we can manipulate headers to continue our attempts.

The **`X-Forwarded-For`** header can be used to **spoof the client's IP address**. This header is often trusted by web servers and proxies to identify the originating IP address of a client making a request.

> 💡 By modifying the value of the `X-Forwarded-For` header, we can **bypass the IP-based brute-force mechanism** and continue sending login attempts without waiting.

### Step 5: Capture the Login Request in Burp Suite

1. Open **Burp Suite** and ensure **Intercept** is turned **ON**.
2. Attempt to log in again using invalid credentials (e.g., `carlos:test123`).

![Intercepting Request](https://github.com/user-attachments/assets/adf47e33-5efb-4ae9-891f-14e47fc2207b)

---

### Step 6: Analyzing the Request

1. Right-click on the captured request and choose **"Send to Repeater"**.
2. Open the **Repeater** tab to view the raw HTTP request.
3. Here, we can observe how the server responds to multiple login attempts from the same IP.

![Send to Repeater](https://github.com/user-attachments/assets/40441db7-c729-44bc-b501-db660d660e2f)

![Response in Repeater](https://github.com/user-attachments/assets/ff024f61-55b2-427a-af41-70e71d3c8c35)

📌 Once your IP is blocked, the server responds with an error message. This is where we’ll start injecting the `X-Forwarded-For` header to spoof new IPs and avoid detection.
Absolutely, Yash — I’ve continued from **Step 7** and refined your write-up while keeping the raw technical tone and clean structure. Here's the fully formatted continuation with the corrected numbering:

---

### Step 7: Modifying the Header to Bypass IP Blocking

Ready for the next part — let’s dive into modifying the header and automating the attack.

3. Send the login request again and observe the server's response.

![image](https://github.com/user-attachments/assets/3842926a-12a6-4433-962f-1f69929ce19c)

4. Use valid credentials now. You’ll notice that you're not blocked.  
   Now deliberately fail a few login attempts to trigger the block again.

5. After just **2 failed attempts**, the IP gets blocked again.

![image](https://github.com/user-attachments/assets/bc3d9ce6-db64-4384-935b-3188a23f9682)

6. To **bypass the block**, add the following header in the request:
   ```
   X-Forwarded-For: 10.10.1.1
   ```

![image](https://github.com/user-attachments/assets/c1f51116-dd2e-4f74-a796-8271cf92252b)

7. After adding the spoofed IP, the timer is reset, and we can resume brute-force attempts.

---

### Step 8: Timing-Based Username Enumeration

8. But wait — there’s another vulnerability: **Response Time Leakage**.

9. Try logging in with a **valid username** and an **invalid password**.

![image](https://github.com/user-attachments/assets/3bc36239-628d-4ec5-bc19-6c5dc7da053d)

10. Note the **response time** shown.

![image](https://github.com/user-attachments/assets/afaa8560-3d2a-4fcd-bee6-2431d9be0c7f)

11. Now enter both **valid username and valid password**.

![image](https://github.com/user-attachments/assets/650510d8-1cef-42c8-abb4-4b6eedb0ddb0)

12. Observe how the **response time changes** compared to the previous attempt.

![image](https://github.com/user-attachments/assets/352c55cf-deba-44e5-acf4-836b503d59d3)

13. Try changing **both username and password** to invalid.

![image](https://github.com/user-attachments/assets/0bc3441e-0d8c-48d1-9d4b-38a33b050fbb)

14. Notice that the **response time is significantly lower** now.

![image](https://github.com/user-attachments/assets/7aba0df4-f540-4c73-a055-2388d8abbd87)

15. Based on these observations:

   | Attempt                          | Response Time |
   |----------------------------------|----------------|
   | ✅ Valid username, ❌ Invalid password | ~243 ms        |
   | ✅ Valid username, ✅ Valid password   | ~209 ms        |
   | ❌ Invalid username & password       | ~163 ms        |

---

### Step 9: Response Time vs Password Length

16. Now increase the password length drastically with a random string.

![image](https://github.com/user-attachments/assets/9e5ff5b5-57ef-46df-9547-b02a8aafec76)

17. You'll observe a **high response delay**, indicating password validation processing.

![image](https://github.com/user-attachments/assets/05fb356b-d4d3-4a59-b4ce-b5415f16d009)

---

Perfect Yash, I’ve continued your write-up from **Step 10** cleanly, corrected any small grammar and structure issues, and preserved your raw, real-time attack documentation style. Here's the polished continuation:

---

### Step 10: Configuring the Intruder Attack

#### Step 4: Automating the Username Enumeration via Response Timing

1. Send the request from Repeater to **Intruder**.

2. In the **Intruder** tab, highlight the username (`admin`) and click `Add §` to mark it as a payload position.

3. Add the following custom header to spoof the IP on each request:
   ```
   X-Forwarded-For: 1
   ```
   > **Note:** Do not reuse IPs you already tested in Repeater — they might be blocked and will cause your brute-force attempt to fail.

![image](https://github.com/user-attachments/assets/78660b6f-dba9-4fa4-803a-bbf20c6ccf88)

4. Change the **Attack type** to **Pitchfork**.

![image](https://github.com/user-attachments/assets/c7b8510a-7e08-44fb-bce5-3e68f11f1c74)

5. Now select `§1§` (for IP spoofing) and the `username` field — Pitchfork allows us to iterate two payload lists in parallel, like Cluster Bomb but with synced indices.

![image](https://github.com/user-attachments/assets/4a2b916a-b379-49de-b56f-54c77205191c)

6. In the password field, input a **long random string** — since we’re only checking response time based on the username, we don’t care about actual password values.

![image](https://github.com/user-attachments/assets/61ce40ae-ad88-4404-bcdf-20477804595f)

### Step 11: Payload Configuration

7. Go to the **Payloads** tab.

8. For **Position 1** (`X-Forwarded-For`), select **Numbers** as the payload type. Configure it as follows:
   - Range: `1 to 101`
   - Step: `1`
   - Max fraction digits: `0`

![image](https://github.com/user-attachments/assets/d8439833-9ee9-4c0d-9bd1-1a4eab7c21e4)
![image](https://github.com/user-attachments/assets/2385eb16-4886-42c7-9f5a-6e0141f69fd3)

9. Now for **Position 2** (username), go to the [Username List](https://github.com/Esther7171/Web-Application-Penetration-Testing/blob/main/Wpt/Server%20Side%20vulnerability/Authentication%20Vulnerabilities/Labs/Lab-credentials/Username-List.md), copy the contents and paste them directly in the payload settings.

![image](https://github.com/user-attachments/assets/39aa14c9-332d-40be-b418-3ed8b653b2d1)  
![image](https://github.com/user-attachments/assets/68eda6f8-aa44-4515-97d6-3d8f1fd34409)

### Step 12: Analyzing the Attack Results

10. Start the Intruder **Attack**.

11. Once the attack finishes, click the 3-dot menu (top-right corner of the results table).

![image](https://github.com/user-attachments/assets/c3d126e0-978c-402b-87ea-e1192bccafdf)

12. Enable the following columns:
   - **Response Time**
   - **Response Length**

![image](https://github.com/user-attachments/assets/0bc4cfde-e7af-419a-863c-7702b3859087)

13. We observe a **significant delay** in the response time for one specific username.

![image](https://github.com/user-attachments/assets/f8a9be40-c78a-4864-8ebc-808b0ef39e2c)

**Result:** Username `an` is confirmed valid based on timing behavior!
Here’s the continuation of your walkthrough from Step 12 with proper formatting and clarity:

---

### Step 13: Finding the Password

Now that we’ve identified the valid username, let’s move on to cracking the password.

1. **Send the request to Intruder** again, and update the **X-Forwarded-For** header to spoof the IP:

   ```
   X-Forwarded-For: 10.1.1.1
   ```

2. **Select the Attack Type** as **Pitchfork** again and configure the positions as shown below:

![image](https://github.com/user-attachments/assets/4280d690-c1bc-4315-b81f-e8dedb55c44b)

3. **In the Payloads side panel**, select **Position 1** (for IP spoofing) from the drop-down list. Choose the **Numbers** payload type, and set the range from `1` to `101`, with a step of `1` and max fraction digits set to `0` (this will be used to spoof your IP).

![image](https://github.com/user-attachments/assets/6c750980-a7f6-4b3a-97e0-4fc022826373)

4. **For Position 2**, change the payload type to the **Password List**. Copy the [Password List](https://github.com/Esther7171/Web-Application-Penetration-Testing/blob/main/Wpt/Server%20Side%20vulnerability/Authentication%20Vulnerabilities/Labs/Lab-credentials/Password-List.md) and paste it into the payload configuration.

![image](https://github.com/user-attachments/assets/46a30c88-fc4f-4727-b8b6-00266015885c)

5. **Start the Attack**.

![image](https://github.com/user-attachments/assets/45a6a1a1-8911-467b-b292-a0ac64b23a96)

---

### Step 14: Successfully Cracked the Password

6. Once the attack is complete, **we’ve successfully obtained the password** for the valid username.

   Now, make the necessary changes in the original request:

![image](https://github.com/user-attachments/assets/b3ff8265-961d-4a44-b020-8b997da1a926)

7. **Forward the request** with the correct password.

![image](https://github.com/user-attachments/assets/66f98f72-10fe-4ac3-8a8f-4c68ad44900f)

---

### ✅ We’ve successfully completed the lab!
