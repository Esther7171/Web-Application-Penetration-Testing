# Lab 3: [Exploiting NoSQL injection to extract data](https://portswigger.net/web-security/nosql-injection/lab-nosql-injection-extract-data)

![image](https://github.com/user-attachments/assets/930bfc39-809c-4e28-92c2-7e817df7030c)

In this lab scenario,the login functionality is backed by a MongoDB NoSQL database and is vulnerable to injection using MongoDB query operators.

Objective: Exploit the NoSQL injection vulnerability to log in as the `administrator` user.

You can also log in to your own account using the following credentials:
* Username: `wiener`
* Password: `peter`

### Accessing the Lab

![image](https://github.com/user-attachments/assets/c900311a-a08a-4585-860e-8bce794cf224)

**Step 1:** Click on the **"My Account"** button.

![image](https://github.com/user-attachments/assets/e4ec3cc2-b72d-428a-98aa-bbd8231f3faa)

**Step 2:**

* Log in using the provided credentials: Username: wiener Password: peter

![image](https://github.com/user-attachments/assets/61846a77-781b-45be-aefb-45f9074731d0)

* Open Burp Suite and go to Proxy tab click on Http History tab.

![image](https://github.com/user-attachments/assets/de07022e-05cf-441a-9cec-ca4fadf2e294)

* In Http history tab Look for `GET /user/lookup?user=wiener` request.

![image](https://github.com/user-attachments/assets/3814791e-26d8-43b7-9334-338ba4878292)

* Right-click &  Send to Repeater To observe.

![image](https://github.com/user-attachments/assets/6f069f9e-76a8-4708-b573-1264a0c1c238)

**Step 3:**

* In Repeater, submit a `'` character in the user parameter. Notice that this causes an error. This may indicate that the user input was not filtered or sanitized correctly.

![image](https://github.com/user-attachments/assets/76090835-468b-4f3a-92c0-a75b405cb00d)

* Submit a valid JavaScript payload in the user parameter. For example, you could use `wiener'+'`,

* Make sure to URL-encode the payload by highlighting it and using the hotkey `Ctrl-U`. Notice that it retrieves the account details for the wiener user, which indicates that a form of server-side injection may be occurring.

![image](https://github.com/user-attachments/assets/d590e8d0-5d68-475f-b470-695150c9b392)

