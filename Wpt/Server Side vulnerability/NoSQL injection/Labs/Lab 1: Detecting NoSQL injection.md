# Lab1:[Detecting NoSQL injection](https://portswigger.net/web-security/nosql-injection/lab-nosql-injection-detection)

![image](https://github.com/user-attachments/assets/a4ad4414-46bc-4bbc-943b-ae4c7cca116c)

In this lab scenario, the product category filter is powered by a MongoDB NoSQL database and is vulnerable to NoSQL injection.

To solve the lab, perform a NoSQL injection attack that forces the application to display unreleased products.

### Accessing the Lab

**Step 1:** Click on **"Product Category filter"** to initiate a request.

![image](https://github.com/user-attachments/assets/e9260b1f-d8d7-4377-a7bc-72cdaa2eeb1d)

**Step 2:**

* Open **Burp Suite** and ensure **Intercept** is turned **ON**.
* Click on the Product Category filter to capture the request in Burp.

![image](https://github.com/user-attachments/assets/e33e2845-da6b-4f7b-b63e-9970ec195d76)

**Step 3:**

* Right-click on the captured request and select **"Send to Repeater"** for further testing.

![image](https://github.com/user-attachments/assets/060f2e20-a01d-456a-affb-a7a7c544946c)

**Step 4:**
Modify the request by submitting a single quote (`'`) in the `category` parameter.
This results in a JavaScript syntax error, suggesting that user input is not properly sanitized or filtered.

![image](https://github.com/user-attachments/assets/be926085-6307-4778-a9bb-5e4816817a13)

**Step 5:**
Now, submit a valid JavaScript payload in the `category` query parameter. Highlight or select the payload, then press `Ctrl + U` in Burp Suite to URL-encode it and prevent any syntax errors.

**Payload before encoding:**

```
Gifts'+'
```

**Payload after encoding:**

```
Gifts'%2b'
```

![image](https://github.com/user-attachments/assets/19825f09-75e8-4248-9c5e-db8264dd46d0)

**Step 6:**
This encoded payload does **not** trigger a syntax error, indicating that some form of server-side injection might be taking place.

**Step 7:**
Test whether you can inject boolean conditions to alter the application's response.

* Try injecting a condition that always evaluates to `true` in the `category` parameter. For example:

```
Gifts' && 1 && 'x
```

**Step 8:**
Make sure to URL-encode the payload to avoid syntax errors. You should notice that products from the **Gifts** category are still retrieved, indicating successful injection.


**Step 9:**
Now inject a different boolean condition that also always evaluates to `true`:

```
Gifts'||1||'
```

> This confirms that the application is vulnerable to NoSQL injection by returning products regardless of the actual category.

![image](https://github.com/user-attachments/assets/16f472c1-bd83-40a0-9d19-1af337913293)

![image](https://github.com/user-attachments/assets/7bdc0864-3300-4603-a39f-c242da0c0a57)


✅ We’ve successfully completed the lab!
